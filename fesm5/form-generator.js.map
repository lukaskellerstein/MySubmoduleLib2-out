{"version":3,"file":"form-generator.js.map","sources":["ng://form-generator/lib/dynamic-form/dynamic-form.component.ts","ng://form-generator/lib/dynamic-field/dynamic-field.directive.ts","ng://form-generator/lib/form-generator.module.ts"],"sourcesContent":["import { Component, OnInit, OnChanges, EventEmitter, Input, Output } from '@angular/core';\nimport { FormGroup, FormBuilder, FormControl } from '@angular/forms';\n\nimport { FieldConfig} from 'MySubmoduleLib1';\nimport { Observable } from 'rxjs';\n\n@Component({\n  selector: 'lib-dynamic-form',\n  template: `<form class=\"dynamic-form\" [formGroup]=\"form\" (submit)=\"handleSubmit($event)\">\n  <ng-container *ngFor=\"let field of config;\" dynamicField [config]=\"field\" [group]=\"form\">\n  </ng-container>\n</form>`,\n  styles: [``]\n})\nexport class DynamicFormComponent implements OnChanges, OnInit {\n  @Input()\n  config: FieldConfig[] = [];\n\n  @Output()\n  submit: EventEmitter<any> = new EventEmitter<any>();\n\n  form: FormGroup;\n\n  get controls() { return this.config.filter(({type}) => type !== 'button'); }\n  get changes(): Observable<any> { return this.form.valueChanges; }\n  get valid() { return this.form.valid; }\n  get value(): any { return this.form.value; }\n\n  constructor(private fb: FormBuilder) {}\n\n  ngOnInit() {\n    this.form = this.createGroup();\n  }\n\n  ngOnChanges() {\n    if (this.form) {\n      const controls = Object.keys(this.form.controls);\n      const configControls = this.controls.map((item) => item.name);\n\n      controls\n        .filter((control) => !configControls.includes(control))\n        .forEach((control) => this.form.removeControl(control));\n\n      configControls\n        .filter((control) => !controls.includes(control))\n        .forEach((name) => {\n          const config = this.config.find((control) => control.name === name);\n          this.form.addControl(name, this.createControl(config));\n        });\n\n    }\n  }\n\n  createGroup() {\n    const group = this.fb.group({});\n    this.controls.forEach(control => group.addControl(control.name, this.createControl(control)));\n    return group;\n  }\n\n  createControl(config: FieldConfig): FormControl {\n    const { disabled, validation, value } = config;\n    return this.fb.control({ disabled, value }, validation);\n  }\n\n  handleSubmit(event: Event) {\n    event.preventDefault();\n    event.stopPropagation();\n    this.submit.emit(this.value);\n  }\n\n  setDisabled(name: string, disable: boolean) {\n    if (this.form.controls[name]) {\n      const method = disable ? 'disable': 'enable';\n      this.form.controls[name][method]();\n      return;\n    }\n\n    this.config = this.config.map((item) => {\n      if (item.name === name) {\n        item.disabled = disable;\n      }\n      return item;\n    });\n  }\n\n  setValue(name: string, value: any) {\n    this.form.controls[name].setValue(value, {emitEvent: true});\n  }\n}\n","import { ComponentFactoryResolver, ComponentRef, Directive, Input, OnChanges, OnInit, Type, ViewContainerRef } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\n\nimport {MyButtonComponent, MyInputComponent, MySelectComponent, Field, FieldConfig} from 'MySubmoduleLib1';\n\nconst components: {[type: string]: Type<Field>} = {\n  button:  MyButtonComponent,\n  input: MyInputComponent,\n  select: MySelectComponent\n};\n\n@Directive({\n  selector: '[dynamicField]'\n})\nexport class DynamicFieldDirective implements Field, OnChanges, OnInit {\n  @Input()\n  config: FieldConfig;\n\n  @Input()\n  group: FormGroup;\n\n  component: ComponentRef<Field>;\n\n  constructor(\n    private resolver: ComponentFactoryResolver,\n    private container: ViewContainerRef\n  ) {}\n\n  ngOnChanges() {\n    if (this.component) {\n      this.component.instance.config = this.config;\n      this.component.instance.group = this.group;\n    }\n  }\n\n  ngOnInit() {\n    if (!components[this.config.type]) {\n      const supportedTypes = Object.keys(components).join(', ');\n      throw new Error(\n        `Trying to use an unsupported type (${this.config.type}).\n        Supported types: ${supportedTypes}`\n      );\n    }\n    const component = this.resolver.resolveComponentFactory<Field>(components[this.config.type]);\n    this.component = this.container.createComponent(component);\n    this.component.instance.config = this.config;\n    this.component.instance.group = this.group;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { DynamicFormComponent } from './dynamic-form/dynamic-form.component';\nimport { UiComponentsModule } from 'MySubmoduleLib1';\nimport { DynamicFieldDirective } from './dynamic-field/dynamic-field.directive';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    UiComponentsModule\n  ],\n  declarations: [DynamicFormComponent, DynamicFieldDirective],\n  exports: [DynamicFormComponent, DynamicFieldDirective]\n})\nexport class FormGeneratorModule { }\n"],"names":[],"mappings":"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"}
